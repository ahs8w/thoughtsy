var el = $('#new_message');
var flash = $('#js_flash_messages');

// remove error messages if present
$('#error_explanation').remove();

<% if @message.errors.any? %>

  el.before("<%= escape_javascript(render('shared/error_messages', object: @message)) %>");
  el.reset();

<% else %>

  $('#messagemodal').modal('hide');
  flash.html("<%= escape_javascript(render('shared/flash_messages')) %>");
  $('#message_toggle').hide();
  flash.fadeOut(5000);

<% end %>