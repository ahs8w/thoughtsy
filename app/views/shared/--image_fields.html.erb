<div id="image_fields_container">
  <div class="image_fields">
    <span>
      <label for="picture">Click to upload a picture</label>
      <%= f.file_field :image, id: "picture" %>
      <span id="filename"></span>
    </span>
    <span><%= f.text_field :remote_image_url, placeholder: "or an image URL" %></span>
    <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
  </div>
</div>




<script type="text/javascript">
  $('#picture').change(function(e) {
      var filepath = this.value;
      var m = filepath.match(/([^\/\\]+)$/);
      var filename = m[1];
      $('#filename').text(' -> ' + filename);
      setTimeout((function(form) {
          return function() {
              form.submit();
          }
      })(this.form), 1000);
  });
</script>